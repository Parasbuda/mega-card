{"version":3,"file":"static/js/873.76eae970.chunk.js","mappings":"8LA2EA,UAvE8B,SAAC,GAAkB,IAAhBA,EAAe,EAAfA,SAEzBC,GADyCD,EAAvCE,gBAAuCF,EAAtBG,mBACVC,EAAAA,EAAAA,KAAY,SAACC,GAAD,OAAWA,EAAMC,YAAYL,YACvCG,EAAAA,EAAAA,KAAY,SAACC,GAAD,OAAWA,EAAME,KAAKC,YAiEnD,OA/DAC,EAAAA,EAAAA,YAAU,WACR,IAAMC,EAAcT,EAAOU,KAAI,SAACC,GAC9B,IACEC,EAOED,EAPFC,QACAC,EAMEF,EANFE,kBACAC,EAKEH,EALFG,mBACAC,EAIEJ,EAJFI,iBACAC,EAGEL,EAHFK,eACAC,EAEEN,EAFFM,iBACAC,EACEP,EADFO,OAEF,MAAO,CACLN,QAAAA,EACAO,KACEN,EAAoB,IAAMC,EAAqB,IAAMC,EACvDC,eAAAA,EACAC,iBAAAA,EACAC,OAAM,OAAEA,QAAF,IAAEA,OAAF,EAAEA,EAAQC,SAiBdC,EAAKC,IAAAA,MAAAA,cAVK,CACd,CACET,QAAS,cACTO,KAAM,OACNH,eAAgB,UAChBC,iBAAkB,gBAClBC,OAAQ,WAIiC,CAC3CI,OAAQ,CACN,UACA,OACA,iBACA,mBACA,UAEFC,YAAY,EACZC,OAAQ,IAGVH,IAAAA,MAAAA,eAA0BD,EAAIX,EAAa,CACzCa,OAAQ,CACN,UACA,OACA,iBACA,mBACA,UAEFC,YAAY,EACZC,QAAS,IAEX,IAAMC,EAAK,CAAEC,OAAQ,CAAEC,KAAMP,GAAMQ,WAAY,CAAC,SAC1CC,EAAcR,IAAAA,MAAWI,EAAI,CAAEK,SAAU,OAAQC,KAAM,UACvDJ,EAAO,IAAIK,KAAK,CAACH,GAAc,CAAEE,KAtCrC,oFAuCFE,IAAAA,OAAiBN,EAAM,qBACtB,KAEI,0B","sources":["Component/ReportModal/PrintExcelReportModal.js"],"sourcesContent":["import React, { useEffect } from \"react\";\r\nimport { useSelector } from \"react-redux\";\r\nimport FileSaver from \"file-saver\";\r\nimport XLSX from \"xlsx\";\r\nconst PrintExcelReportModal = ({ formData }) => {\r\n  const { formatedEndDate, formatedStartDate } = formData;\r\n  const prints = useSelector((state) => state.printReport.prints);\r\n  const username = useSelector((state) => state.auth.username);\r\n\r\n  useEffect(() => {\r\n    const updatedData = prints.map((record) => {\r\n      const {\r\n        card_no,\r\n        first_name_nepali,\r\n        middle_name_nepali,\r\n        last_name_nepali,\r\n        address_nepali,\r\n        mobile_no_nepali,\r\n        branch,\r\n      } = record;\r\n      return {\r\n        card_no,\r\n        name:\r\n          first_name_nepali + \" \" + middle_name_nepali + \" \" + last_name_nepali,\r\n        address_nepali,\r\n        mobile_no_nepali,\r\n        branch: branch?.name,\r\n      };\r\n    });\r\n    const fileType =\r\n      \"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=UTF-8\";\r\n    const fileExtension = \".xlsx\";\r\n\r\n    const Heading = [\r\n      {\r\n        card_no: \"Card Number\",\r\n        name: \"Name\",\r\n        address_nepali: \"Address\",\r\n        mobile_no_nepali: \"Mobile Number\",\r\n        branch: \"Branch\",\r\n      },\r\n    ];\r\n\r\n    const ws = XLSX.utils.json_to_sheet(Heading, {\r\n      header: [\r\n        \"card_no\",\r\n        \"name\",\r\n        \"address_nepali\",\r\n        \"mobile_no_nepali\",\r\n        \"branch\",\r\n      ],\r\n      skipHeader: true,\r\n      origin: 0, //ok\r\n    });\r\n    // ws[\"!cols\"] = wscols;\r\n    XLSX.utils.sheet_add_json(ws, updatedData, {\r\n      header: [\r\n        \"card_no\",\r\n        \"name\",\r\n        \"address_nepali\",\r\n        \"mobile_no_nepali\",\r\n        \"branch\",\r\n      ],\r\n      skipHeader: true,\r\n      origin: -1, //ok\r\n    });\r\n    const wb = { Sheets: { data: ws }, SheetNames: [\"data\"] };\r\n    const excelBuffer = XLSX.write(wb, { bookType: \"xlsx\", type: \"array\" });\r\n    const data = new Blob([excelBuffer], { type: fileType });\r\n    FileSaver.saveAs(data, \"card print\" + fileExtension);\r\n  }, []);\r\n\r\n  return <></>;\r\n};\r\n\r\nexport default PrintExcelReportModal;\r\n"],"names":["formData","prints","formatedEndDate","formatedStartDate","useSelector","state","printReport","auth","username","useEffect","updatedData","map","record","card_no","first_name_nepali","middle_name_nepali","last_name_nepali","address_nepali","mobile_no_nepali","branch","name","ws","XLSX","header","skipHeader","origin","wb","Sheets","data","SheetNames","excelBuffer","bookType","type","Blob","FileSaver"],"sourceRoot":""}